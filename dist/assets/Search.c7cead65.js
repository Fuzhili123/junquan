import{E as K,r as f,c as V,w as A,b as W,G as h,H as r,I as u,J as s,j as n,L as m,K as i,F as z,O as M,N as v,x as k,U as X}from"./vendor.1464d7bc.js";import{_ as Z,u as Q}from"./index.e7a33a97.js";import{T as $}from"./vant.377d2ced.js";import"./utils.0eea1c46.js";const ee={class:"search-page"},ae={class:"search-form"},le={class:"form-actions"},se={key:0,class:"search-results"},oe={class:"result-header"},te={class:"result-count"},ne={class:"result-list"},re=["onClick"],ue={class:"item-header"},de={class:"item-title"},ie={class:"sheet-name"},ce={class:"item-content"},ve={key:0,class:"item-row"},pe={class:"value"},_e={key:1,class:"item-row"},fe={class:"value"},me={key:2,class:"item-row"},he={class:"value"},ge={key:3,class:"item-row"},be={class:"value"},ye={key:4,class:"item-row"},Ve={class:"value"},ke={key:5,class:"item-row"},we={class:"value"},Pe={key:6,class:"item-row"},Ce={class:"value"},Se={key:7,class:"item-row"},De={class:"value"},Oe={class:"item-footer"},je={key:0,class:"pagination"},Ne={class:"pagination-info"},Te={class:"pagination-controls"},Ue={class:"page-numbers"},xe=["onClick"],ze={key:1,class:"empty-state"},j=20,Me={__name:"Search",setup($e){const w=K(),_=Q(),P=f(!1),b=f(!1),F=f(!1),N=f(!1),d=f(1),p=f(0),T=f(!1),o=V(()=>_.searchParams),g=V(()=>_.filteredCount);V(()=>_.filteredData);const U=V(()=>_.loading),C=f([]),S=()=>{_.searchData(),P.value=!0,d.value=1,p.value=Math.ceil(g.value/j),T.value=g.value>j,D(),g.value===0?$("\u672A\u627E\u5230\u5339\u914D\u7684\u6570\u636E"):$(`\u627E\u5230${g.value}\u6761\u6570\u636E\uFF0C\u5171${p.value}\u9875`)},I=()=>{_.resetSearch(),P.value=!1,C.value=[],d.value=1,N.value=!1},D=()=>{const a=_.getPaginatedData(d.value,j);C.value=a.data,p.value=a.totalPages,N.value=d.value>=a.totalPages,F.value=!1},O=a=>{a<1||a>p.value||(d.value=a,D())},R=()=>{d.value>1&&O(d.value-1)},q=()=>{d.value<p.value&&O(d.value+1)},E=()=>{const a=[],e=p.value,c=d.value;if(e<=7)for(let t=1;t<=e;t++)a.push(t);else if(c<=4){for(let t=1;t<=5;t++)a.push(t);a.push("..."),a.push(e)}else if(c>=e-3){a.push(1),a.push("...");for(let t=e-4;t<=e;t++)a.push(t)}else{a.push(1),a.push("...");for(let t=c-1;t<=c+1;t++)a.push(t);a.push("..."),a.push(e)}return a},B=async()=>{b.value=!0;try{_.searchData(),d.value=1,D()}finally{b.value=!1}},L=a=>{if(a.\u540D\u79F0&&a.\u540D\u79F0.toString().trim())return a.\u540D\u79F0.toString().trim();const e=[];return a.\u6797\u573A&&e.push(a.\u6797\u573A),a.\u6797\u961F&&e.push(a.\u6797\u961F),a.\u5C0F\u73ED&&e.push(a.\u5C0F\u73ED),e.length>0?e.join(" - "):"\u672A\u77E5\u9879\u76EE"},Y=a=>{a._id||(a._id=`item_${Date.now()}_${Math.random().toString(36).substr(2,9)}`),console.log("=== \u8BE6\u60C5\u9875\u6570\u636E\u7ED3\u6784 ==="),console.log("\u9879\u76EEID:",a._id),console.log("\u5DE5\u4F5C\u8868:",a._sheetName),console.log("\u884C\u53F7:",a._rowIndex),console.log("\u5B8C\u6574\u6570\u636E\u7ED3\u6784:",a),console.log("\u6570\u636E\u7ED3\u6784\u5B57\u6BB5\u5217\u8868:",Object.keys(a)),console.log("\u6570\u636E\u5B57\u6BB5\u7EDF\u8BA1:",{\u603B\u5B57\u6BB5\u6570:Object.keys(a).length,\u6709\u503C\u5B57\u6BB5\u6570:Object.values(a).filter(e=>e!==""&&e!==null&&e!==void 0).length,\u7A7A\u5B57\u6BB5\u6570:Object.values(a).filter(e=>e===""||e===null||e===void 0).length}),console.log("========================"),w.push({name:"Detail",params:{id:a._id},query:{data:JSON.stringify(a)}})};return A(()=>w.currentRoute.value.query,a=>{a&&Object.keys(a).length>0&&(Object.keys(a).forEach(e=>{o.value.hasOwnProperty(e)&&(o.value[e]=a[e])}),S())},{immediate:!0}),W(()=>{const a=w.currentRoute.value.query;a&&Object.keys(a).length>0&&(Object.keys(a).forEach(e=>{o.value.hasOwnProperty(e)&&(o.value[e]=a[e])}),S())}),(a,e)=>{const c=h("van-field"),t=h("van-cell-group"),y=h("van-button"),J=h("van-form"),x=h("van-icon"),G=h("van-pull-refresh");return r(),u("div",ee,[s("div",ae,[n(J,{onSubmit:S},{default:m(()=>[n(t,{inset:""},{default:m(()=>[n(c,{modelValue:o.value.forestFarm,"onUpdate:modelValue":e[0]||(e[0]=l=>o.value.forestFarm=l),name:"forestFarm",label:"\u6797\u573A",placeholder:"\u8BF7\u8F93\u5165\u6797\u573A\u540D\u79F0",clearable:""},null,8,["modelValue"]),n(c,{modelValue:o.value.forestTeam,"onUpdate:modelValue":e[1]||(e[1]=l=>o.value.forestTeam=l),name:"forestTeam",label:"\u6797\u961F",placeholder:"\u8BF7\u8F93\u5165\u6797\u961F\u540D\u79F0",clearable:""},null,8,["modelValue"]),n(c,{modelValue:o.value.smallClass,"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.smallClass=l),name:"smallClass",label:"\u5C0F\u73ED",placeholder:"\u8BF7\u8F93\u5165\u5C0F\u73ED\u540D\u79F0",clearable:""},null,8,["modelValue"]),n(c,{modelValue:o.value.renewalMethod,"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.renewalMethod=l),name:"renewalMethod",label:"\u66F4\u65B0\u65B9\u5F0F",placeholder:"\u5982\uFF1A\u690D\u82D7",clearable:""},null,8,["modelValue"]),n(c,{modelValue:o.value.renewalYear,"onUpdate:modelValue":e[4]||(e[4]=l=>o.value.renewalYear=l),name:"renewalYear",label:"\u66F4\u65B0\u5E74\u5EA6",placeholder:"\u5982\uFF1A2016",type:"number",clearable:""},null,8,["modelValue"]),n(c,{modelValue:o.value.operationContent,"onUpdate:modelValue":e[5]||(e[5]=l=>o.value.operationContent=l),name:"operationContent",label:"\u4F5C\u4E1A\u5185\u5BB9",placeholder:"\u5982\uFF1A\u6E05\u7406\u8FF9\u5730",clearable:""},null,8,["modelValue"]),n(c,{modelValue:o.value.operator,"onUpdate:modelValue":e[6]||(e[6]=l=>o.value.operator=l),name:"operator",label:"\u4F5C\u4E1A\u4EBA",placeholder:"\u8BF7\u8F93\u5165\u4F5C\u4E1A\u4EBA\u59D3\u540D",clearable:""},null,8,["modelValue"]),n(c,{modelValue:o.value.acceptancePerson,"onUpdate:modelValue":e[7]||(e[7]=l=>o.value.acceptancePerson=l),name:"acceptancePerson",label:"\u9A8C\u6536\u4EBA",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u6536\u4EBA\u59D3\u540D",clearable:""},null,8,["modelValue"])]),_:1}),s("div",le,[n(y,{type:"primary","native-type":"submit",size:"large",loading:U.value,class:"search-btn"},{default:m(()=>[...e[9]||(e[9]=[k(" \u641C\u7D22 ",-1)])]),_:1},8,["loading"]),n(y,{type:"default",size:"large",onClick:I,class:"reset-btn"},{default:m(()=>[...e[10]||(e[10]=[k(" \u91CD\u7F6E ",-1)])]),_:1})])]),_:1})]),P.value?(r(),u("div",se,[s("div",oe,[e[11]||(e[11]=s("h3",null,"\u641C\u7D22\u7ED3\u679C",-1)),s("span",te,"\u5171"+i(g.value)+"\u6761\u6570\u636E",1)]),n(G,{modelValue:b.value,"onUpdate:modelValue":e[8]||(e[8]=l=>b.value=l),onRefresh:B},{default:m(()=>[s("div",ne,[(r(!0),u(z,null,M(C.value,l=>(r(),u("div",{key:l._id||`item_${Math.random()}`,class:"result-item",onClick:H=>Y(l)},[s("div",ue,[s("span",de,i(L(l)),1),s("span",ie,i(l._sheetName||"\u672A\u77E5\u5DE5\u4F5C\u8868"),1)]),s("div",ce,[l.\u6797\u573A?(r(),u("div",ve,[e[12]||(e[12]=s("span",{class:"label"},"\u6797\u573A\uFF1A",-1)),s("span",pe,i(l.\u6797\u573A),1)])):v("",!0),l.\u6797\u961F?(r(),u("div",_e,[e[13]||(e[13]=s("span",{class:"label"},"\u6797\u961F\uFF1A",-1)),s("span",fe,i(l.\u6797\u961F),1)])):v("",!0),l.\u5C0F\u73ED?(r(),u("div",me,[e[14]||(e[14]=s("span",{class:"label"},"\u5C0F\u73ED\uFF1A",-1)),s("span",he,i(l.\u5C0F\u73ED),1)])):v("",!0),l.\u4F5C\u4E1A\u5185\u5BB9?(r(),u("div",ge,[e[15]||(e[15]=s("span",{class:"label"},"\u4F5C\u4E1A\u5185\u5BB9\uFF1A",-1)),s("span",be,i(l.\u4F5C\u4E1A\u5185\u5BB9),1)])):v("",!0),l.\u4F5C\u4E1A\u4EBA?(r(),u("div",ye,[e[16]||(e[16]=s("span",{class:"label"},"\u4F5C\u4E1A\u4EBA\uFF1A",-1)),s("span",Ve,i(l.\u4F5C\u4E1A\u4EBA),1)])):v("",!0),l.\u4F5C\u4E1A\u9762\u79EF?(r(),u("div",ke,[e[17]||(e[17]=s("span",{class:"label"},"\u4F5C\u4E1A\u9762\u79EF\uFF1A",-1)),s("span",we,i(l.\u4F5C\u4E1A\u9762\u79EF)+"\u4EA9",1)])):v("",!0),l.\u4F5C\u4E1A\u4EBA?(r(),u("div",Pe,[e[18]||(e[18]=s("span",{class:"label"},"\u4F5C\u4E1A\u4EBA\uFF1A",-1)),s("span",Ce,i(l.\u4F5C\u4E1A\u4EBA),1)])):v("",!0),l.\u4F5C\u4E1A\u5B8C\u6210\u65E5\u671F?(r(),u("div",Se,[e[19]||(e[19]=s("span",{class:"label"},"\u5B8C\u6210\u65E5\u671F\uFF1A",-1)),s("span",De,i(l.\u4F5C\u4E1A\u5B8C\u6210\u65E5\u671F),1)])):v("",!0)]),s("div",Oe,[n(x,{name:"arrow"})])],8,re))),128))])]),_:1},8,["modelValue"]),T.value&&p.value>1?(r(),u("div",je,[s("div",Ne,[s("span",null,"\u7B2C "+i(d.value)+" \u9875\uFF0C\u5171 "+i(p.value)+" \u9875",1)]),s("div",Te,[n(y,{type:"default",size:"small",disabled:d.value<=1,onClick:R},{default:m(()=>[...e[20]||(e[20]=[k(" \u4E0A\u4E00\u9875 ",-1)])]),_:1},8,["disabled"]),s("div",Ue,[(r(!0),u(z,null,M(E(),l=>(r(),u("span",{key:l,class:X(["page-number",{active:l===d.value}]),onClick:H=>O(l)},i(l),11,xe))),128))]),n(y,{type:"default",size:"small",disabled:d.value>=p.value,onClick:q},{default:m(()=>[...e[21]||(e[21]=[k(" \u4E0B\u4E00\u9875 ",-1)])]),_:1},8,["disabled"])])])):v("",!0)])):U.value?v("",!0):(r(),u("div",ze,[n(x,{name:"search",size:"48",color:"#ccc"}),e[22]||(e[22]=s("p",null,"\u8BF7\u8F93\u5165\u641C\u7D22\u6761\u4EF6\u5F00\u59CB\u67E5\u8BE2",-1))]))])}}};var Ee=Z(Me,[["__scopeId","data-v-4ba57ac6"]]);export{Ee as default};
